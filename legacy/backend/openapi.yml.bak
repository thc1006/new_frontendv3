openapi: 3.0.2
info:
  title: ORAN Flask RESTful API
  description: NYCU 2024 ORAN RESTful API MySQL
  version: 0.1.0
servers:
  - url: http://140.113.144.121:2980
components:
  schemas:
    User:
      type: object
      properties:
        UID:
          type: integer
          example: 1
        account:
          type: string
          example: user1
        password:
          type: string
          example: 1
        email:
          type: string
          example: user1@gmail.com
        salt:
          type: string
          example: asdfghjkl;
          
    User_info:
      type: object
      properties:
        account:
          type: string
          example: user3
        password:
          type: string
          example: 3
        email:
          type: string
          example: user3@gmail.com
        salt:
          type: string
          example: asdfghjkl;

    Project:
      type: object
      properties:
        PID:
          type: integer
          example: 3
        title:
          type: string
          example: project3
        date:
          type: string
          example: "2024-07-03"
          
    Project_Map:
      type: object
      properties:
        PID:
          type: integer
          example: 3
        title:
          type: string
          example: project3
        date:
          type: string
          example: "2024-07-03"
        MID:
          type: integer
          example: 1
        image:
          type: string
          example: base64 encode image
        position:
          $ref: '#/components/schemas/Position'
        
          
    Project_info:
      type: object
      properties:
        title:
          type: string
          example: project3
        date:
          type: string
          example: "2024-07-03"
          
    Project_list:
      type: object
      properties:
        project1:
          $ref: '#/components/schemas/Project'
        project2:
          $ref: '#/components/schemas/Project'
    
    User_list:
      type: object
      properties:
        user1:
          $ref: '#/components/schemas/User'
        user2:
          $ref: '#/components/schemas/User'
          
    User_Project_Relation:
      type: object
      properties:
        UID:
          type: integer
          example: 1
        PID:
          type: integer
          example: 1
        auth:
          type: string
          example: admin
          
    CU:
      type: object
      properties:
        CUID:
          type: integer
          example: 1
        PID:
          type: integer
          example: 1
        name:
          type: string
          example: p1_cu1
    
    DU:
      type: object
      properties:
        DUID:
          type: integer
          example: 1
        CUID:
          type: integer
          example: 1
        PID:
          type: integer
          example: 1
        name:
          type: string
          example: p1_du1
              
    DU_info:
      type: object
      properties:
        CUID:
          type: integer
          example: 1
        PID:
          type: integer
          example: 1
        name:
          type: string
          example: p1_du1
          
    DU_list:
      type: object
      properties:
        DU1:
          $ref: '#/components/schemas/DU'
        DU2:
          $ref: '#/components/schemas/DU'
          
    RU:
      type: object
      properties:
        RUID:
          type: integer
          example: 1
        name:
          type: string
          example: p1_ru1
        DUID:
          type: integer
          example: 1
        PID:
          type: integer
          example: 1
        location_x:
          type: number
          example: 1.2
        location_y:
          type: number
          example: 1.2
        location_z:
          type: number
          example: 1.2
        IP:
          type: string
          example: 127.0.0.1
        state:
          type: integer
          example: 1
        power:
          type: integer
          example: 1
        mac_4g:
          type: string
          example: xx:xx:xx:xx:xx:xx
        mac_5g:
          type: string
          example: xx:xx:xx:xx:xx:xx
        ch:
          type: integer
          example: 1
        protocol:
          type: string
          example: protocal/xx 8.0.3
        format:
          type: number
          example: 1.2
        throughput:
          type: number
          example: 1.2
    
    RU_info:
      type: object
      properties:
        DUID:
          type: integer
          example: 1
        name:
          type: string
          example: p1_ru1
        PID:
          type: integer
          example: 1
        location_x:
          type: number
          example: 1.2
        location_y:
          type: number
          example: 1.2
        location_z:
          type: number
          example: 1.2
        IP:
          type: string
          example: 127.0.0.1
        state:
          type: integer
          example: 1
        power:
          type: integer
          example: 1
        mac_4g:
          type: string
          example: xx:xx:xx:xx:xx:xx
        mac_5g:
          type: string
          example: xx:xx:xx:xx:xx:xx
        ch:
          type: integer
          example: 1
        protocol:
          type: string
          example: protocal/xx 8.0.3
        format:
          type: number
          example: 1.2
        throughput:
          type: number
          example: 1.2
          
    RU_list:
      type: object
      properties:
        RU1:
          $ref: '#/components/schemas/RU'
        RU2:
          $ref: '#/components/schemas/RU'
    
    Position:
      type: object
      properties:
        left_down_long:
          type: number
          example: 101.123321
        left_down_lat:
          type: number
          example: 101.123321  
        left_up_long:
          type: number
          example: 101.123321
        left_up_lat:
          type: number
          example: 101.123321 
        right_down_long:
          type: number
          example: 101.123321
        right_down_lat:
          type: number
          example: 101.123321  
        right_up_long:
          type: number
          example: 101.123321
        right_up_lat:
          type: number
          example: 101.123321  
          
    Map:
      type: object
      properties:
        MID:
          type: integer
          example: 1
        PID:
          type: integer
          example: 1
        image:
          type: string
          example: ./img/xxx.png
        position:
          $ref: '#/components/schemas/Position'
          
    Map_image:
      type: object
      properties:
        image:
          type: string
          example: base64 encode xxx.png
      
    Map_info:
      type: object
      properties:
        image:
          type: string
          example: base64 encode xxx.png
        position:
          $ref: '#/components/schemas/Position'
          
tags:
  - name: User
  - name: Project
  - name: User Project Relation
  - name: CU
  - name: DU
  - name: RU
  - name: Map
    
paths:
  /User:
    post:
      tags:
        - User
      summary: Create a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User_info'
          
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          
  /User/Account/{account}:
    get:
      tags:
        - User
      summary: Return a user by account
      parameters:
        - name: account
          in: path
          required: true
          schema:
            type: string
            example: user1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404':
          description: User not found!
          
  /User/Email/{email}:
    get:
      tags:
        - User
      summary: Return a user by email
      parameters:
        - name: email
          in: path
          required: true
          schema:
            type: string
            example: user1@gmail.com
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404':
          description: User not found!
      
  /User/{UID}:
    put:
      tags:
        - User
      summary: Update a user by UID
      parameters:
        - name: UID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User_info'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404':
          description: User not found!
          
    delete:
      tags:
        - User
      summary: Delete a user by UID
      parameters:
        - name: UID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
        '404':
          description: User not found!      
          
  /Project:
    post:
      tags:
        - Project
      summary: Create a new project
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Project_info'
          
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project' 
                
  /Project/{PID}:
    get:
      tags:
        - Project
      summary: Search project and its related map with PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project_Map' 
        '404':
          description: Project not found!
            
    put:
      tags:
        - Project
      summary: Update a project by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Project_info'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
        '404':
          description: Project not found!
            
    delete:
      tags:
        - Project
      summary: Delete a project by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
        '404':
          description: Project not found!   
          
  /User_Project/User/{UID}:
    get:
      tags:
        - User Project Relation 
      summary: Search all project associate with UID 
      parameters:
        - name: UID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project_list'
        '404':
          description: User's Project not found!
          
  /User_Project/Project/{PID}:
    get:
      tags:
        - User Project Relation 
      summary: Search all user associate with PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User_list'
        '404':
          description: Project not found!  
  
  /User_Project/{PID}/{UID}:
    post:
      tags:
        - User Project Relation
      summary: Create a relation between UID and PID 
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
        - name: UID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                auth:
                  type: string
                  example: "admin"
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User_Project_Relation' 
                
  /CU/{PID}:
    get:
      tags: 
        - CU
      summary: Search CU by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CU'
        '404':
          description: CU not found!
  
  /CU:  
    post:
      tags:
        - CU
      summary: Create CU
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                PID:
                  type: integer
                  example: 1
                name:
                  type: string
                  example: "p1 cu1"
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CU'
  

                ==========================================
  /CU/{CUID}:
    delete:
      tags:
        - CU
      summary: Delete a CU by CUID
      parameters:
        - name: CUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request (There is still DU associate with this CUID)
        '404':
          description: CU not found!
          
  /CU/{CUID}/{PID}:
    put:
      tags:
        - CU
      summary: Update a CU
      parameters:
        - name: CUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CU'
        '404':
          description: CU not found!

  /DU:
    post:
      tags:
        - DU
      summary: Create a DU by CUID and PID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DU_info'
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DU'
      
  /DU/CUID/{CUID}:
    get:
      tags: 
        - DU
      summary: Search DU by CUID
      parameters:
        - name: CUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DU_list'
        '404':
          description: DU not found!
          
  /DU/PID/{PID}:
    get:
      tags: 
        - DU
      summary: Search DU by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DU_list'
        '404':
          description: DU not found!
          
  /DU/{DUID}:
    delete:
      tags:
        - DU
      summary: Delete DU by DUID
      parameters:
        - name: DUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request (There is still RU associate with this DUID)
        '404':
          description: DU not found!  
          
    put:
      tags:
        - DU
      summary: Update DU by DUID
      parameters:
        - name: DUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DU_info'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DU'
        '404':
          description: DU not found!
          
          
  /RU:
    post:
      tags:
        - RU
      summary: Create a RU by RU_info
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RU_info'
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RU'
      
  /RU/DUID/{DUID}:
    get:
      tags: 
        - RU
      summary: Search RU by DUID
      parameters:
        - name: DUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RU_list'
        '404':
          description: RU not found!
          
  /RU/PID/{PID}:
    get:
      tags: 
        - RU
      summary: Search RU by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RU_list'
        '404':
          description: RU not found!
          
  /RU/{RUID}:
    delete:
      tags:
        - RU
      summary: Delete RU by RUID
      parameters:
        - name: RUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
        '404':
          description: DU not found!  
          
    put:
      tags:
        - RU
      summary: Update RU by RUID
      parameters:
        - name: RUID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RU_info'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RU'
        '404':
          description: RU not found!
  
  /Map/{PID}:
    post:
      tags:
        - Map
      summary: Create Map by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Map_info'
      responses:
        '201':
          description: Create
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Map'
                
  /Map/Image/{MID}:
    put:
      tags:
        - Map
      summary: Update Map image
      parameters:
        - name: MID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Map_image'
      responses:
        '200':
          description: OK
        '404':
          description: Map not found!
          
  /Map/Position/{MID}:
    put:
      tags:
        - Map
      summary: Update Map image
      parameters:
        - name: MID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Position'
      responses:
        '200':
          description: OK
        '404':
          description: Map not found!
          
  /Map/{MID}:
    delete:
      tags:
        - Map
      summary: Delete Map by MID
      parameters:
        - name: MID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
        '404':
          description: Map not found!
  /Map/PID/{PID}:
    get:
      tags:
        - Map
      summary: Get Map by PID
      parameters:
        - name: PID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Map'
        '404':
          description: Map not found!
          
  /Map/MID/{MID}:
    get:
      tags:
        - Map
      summary: Get Map by MID
      parameters:
        - name: MID
          in: path
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Map'
        '404':
          description: Map not found!
          
